var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function s(t){try{u(o.next(t))}catch(e){i(e)}}function a(t){try{u(o["throw"](t))}catch(e){i(e)}}function u(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(s,a)}u((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return o([t,e])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,i&&(s=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(o){n=[6,o],i=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},SQNode=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(eui.Component);__reflect(SQNode.prototype,"SQNode");var HttpActionData=function(){function t(t){this.body={},this.validate(t)}return t.prototype.validate=function(t){throw new Error("需要子类实现")},t}();__reflect(HttpActionData.prototype,"HttpActionData",["IHttpActionData"]);var SQApi=function(){function t(){}return t.prototype.fetchJson=function(t,e,n){var o=this,r=new egret.HttpRequest;r.responseType=egret.HttpResponseType.TEXT,r.open(t.url,egret.HttpMethod.GET),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("Access-Control-Allow-Origin","*");for(var i=0,s=Object.keys(t.header);i<s.length;i++){var a=s[i];r.setRequestHeader(a,t.header[a])}r.send(),r.addEventListener(egret.Event.COMPLETE,function(t){var r=t.currentTarget.response;if(!r)return void n(new SQApiError({message:"HTTP GET response is null"}));var i=JSON.parse(r);i.ok?e(i.result):n(o.getResponseError(i))},this),r.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){n(new SQApiError({message:"无法连接到服务器"}))},this)},t.prototype.postReturnJson=function(t,e,n){var o=this,r=t.url+this.buildParams(t.parameters),i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.open(r,egret.HttpMethod.POST);for(var s=0,a=Object.keys(t.header);s<a.length;s++){var u=a[s];i.setRequestHeader(u,t.header[u])}if(i.addEventListener(egret.Event.COMPLETE,function(t){var r=t.currentTarget.response;if(!r)return void n(new SQApiError({message:"HTTP POST response is null"}));var i=JSON.parse(r);i.ok?e(i.result):n(o.getResponseError(i))},this),i.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){n(new SQApiError({message:"无法连接到服务器"}))},this),t.body){var c=this.buildBody(t.body);i.send(c)}else i.send()},t.prototype.getResponseError=function(t){if(t.errors){if(t.errors.length<=0)return new SQApiError({message:"服务器请求错误返回格式不对。"});var e=t.errors[0],n=e.message;return e.field&&(n=n+" ("+e.field+")"),new SQApiError({message:n,error_type:t.errors[0].error_type})}return new SQApiError({message:t.message,error_type:t.error_type})},t.prototype.buildParams=function(t){if(!t)return"";var e="?";for(var n in t)n&&(e=e+n+"="+t[n]+"&");return e=e.slice(0,-1)},t.prototype.buildBody=function(t){return JSON.stringify(t)},t}();__reflect(SQApi.prototype,"SQApi");var NoAuthorizedHeaderFactory=function(){function t(t){this.header={Accept:"application/json","Access-Control-Allow-Origin":"*","Content-Type":"application/json"}}return t.prototype.create=function(){return this.header},t}();__reflect(NoAuthorizedHeaderFactory.prototype,"NoAuthorizedHeaderFactory",["IHeaderFactory"]);var SQLayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){for(var t=this.numChildren,n=0;t>n;n+=1){var o=this.getChildAt(n);o instanceof e&&o.onEnter()}},e.prototype.onExit=function(){for(var t=this.numChildren,n=0;t>n;n+=1){var o=this.getChildAt(n);o instanceof e&&o.onExit()}},e}(SQNode);__reflect(SQLayer.prototype,"SQLayer");var SQScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){for(var t=this.numChildren,e=0;t>e;e+=1){var n=this.getChildAt(e);n instanceof SQLayer&&n.onEnter()}},e.prototype.onExit=function(){for(var t=this.numChildren,e=0;t>e;e+=1){var n=this.getChildAt(e);n instanceof SQLayer&&n.onExit()}},e}(SQNode);__reflect(SQScene.prototype,"SQScene");var PostAnswerData=function(t){function e(e){var n=t.call(this,e)||this;return n.url=SQApiConfig.Host+"/"+SQApiConfig.V1+"/quiz/marathon/"+e.game_id+"/answer",n.headerFactory=new AuthorizedHeaderFactory({access_token:e.access_token}),n.body.user_id=e.user_id,n.body.question_id=e.question_id,n.body.quiz_token=e.quiz_token,n.body.duration_seconds=e.duration_seconds,n.body.answer=e.answer,n}return __extends(e,t),e.prototype.validate=function(t){this.isLegal=!0},e}(HttpActionData);__reflect(PostAnswerData.prototype,"PostAnswerData");var SQEventCenter=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.sharedInstance=function(){return e.instance||(e.instance=new e),e.instance},e}(egret.EventDispatcher);__reflect(SQEventCenter.prototype,"SQEventCenter");var GameOverScene=function(t){function e(e){var n=t.call(this)||this;return n.skinName="GameOverSceneUI",n.model=e,n.continueButton.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onPressContinueButton,n),n}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.setGameInformations()},e.prototype.setGameInformations=function(){this.answerCorrectInfo.setTitleText("答对题目"),this.answerCorrectInfo.setValueText(String(this.model.getAnswerCorrectAmount())),this.answerWrongInfo.setTitleText("答错题目"),this.answerWrongInfo.setValueText(String(this.model.getAnswerWrongAmount()))},e.prototype.onPressContinueButton=function(){this.joinGame()},e.prototype.joinGame=function(){var t=this,e=new JoinGameData({user_id:UserModel.sharedInstance().attribute.id}),n=new SQLoadingLayer;n.show(),UserModel.sharedInstance().actionModel.joinGame(e,function(e){UserModel.sharedInstance().attribute.setGameId(e.game_id),t.goPlayingScene(n)},function(t){n.hide(),console.log(t)})},e.prototype.goPlayingScene=function(t){var e=this,n=new QuizSceneModel;n.fetchQuestions(function(){t.hide(),SQSceneManager.sharedInstance().removeChildLayer(e),SQSceneManager.sharedInstance().replaceScene(new QuizScene(n))},function(e){console.log(e),t.hide()})},e}(SQScene);__reflect(GameOverScene.prototype,"GameOverScene");var GameOverSceneModel=function(){function t(t){this.answerCorrectAmount=t.answer_correct_amount,this.answerWrongAmount=t.answer_wrong_amount}return t.prototype.getAnswerCorrectAmount=function(){return this.answerCorrectAmount},t.prototype.getAnswerWrongAmount=function(){return this.answerWrongAmount},t}();__reflect(GameOverSceneModel.prototype,"GameOverSceneModel");var GameOverInfoItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="GameOverInfoItemUI",e}return __extends(e,t),e.prototype.setTitleText=function(t){this.titleLabel.text=t},e.prototype.setValueText=function(t){this.valueLabel.text=t},e}(SQLayer);__reflect(GameOverInfoItem.prototype,"GameOverInfoItem");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function o(o){e.call(n,o,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?o(r):RES.getResAsync(t,o,this)}else RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){Device.sharedInstance().isPCBrowser()&&(this.stage.orientation=egret.OrientationMode.LANDSCAPE,this.stage.scaleMode=egret.StageScaleMode.SHOW_ALL),egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadPreloadResourceGroup()];case 1:return e.sent(),this.createLaunchGameScene(),[4,platform.login()];case 2:return e.sent(),[4,platform.getUserInfo()];case 3:return t=e.sent(),console.log(t),[2]}})})},e.prototype.loadPreloadResourceGroup=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return n.sent(),this.stage.removeChild(t),[3,5];case 4:return e=n.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var o=new eui.Theme("resource/default.thm.json",t.stage);o.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createLaunchGameScene=function(){SQSceneManager.sharedInstance().addRootStage(this),SQSceneManager.sharedInstance().pushScene(new LaunchGameScene)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var SQApiConfig=function(){function t(){}return t.Host="https://api.shafayouxi.org",t.V1="v1",t}();__reflect(SQApiConfig.prototype,"SQApiConfig");var SQApiErrorType;!function(t){t[t.None=0]="None",t[t.UserNotFound=1]="UserNotFound"}(SQApiErrorType||(SQApiErrorType={}));var SQApiError=function(t){function e(e){var n=t.call(this)||this;return n.message=e.message,"user_not_found"===e.error_type?n.type=SQApiErrorType.UserNotFound:n.type=SQApiErrorType.None,n}return __extends(e,t),e}(Error);__reflect(SQApiError.prototype,"SQApiError");var HttpPost=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t,e,n){var o={url:t.url,header:t.headerFactory.create(),body:t.body};this.postReturnJson(o,function(t){e(t)},function(t){n(t)})},e}(SQApi);__reflect(HttpPost.prototype,"HttpPost",["IHttpAction"]);var AuthorizedHeaderFactory=function(t){function e(e){var n=t.call(this,e)||this;return e.access_token&&(n.header.Authorization="Bearer "+e.access_token),n}return __extends(e,t),e}(NoAuthorizedHeaderFactory);__reflect(AuthorizedHeaderFactory.prototype,"AuthorizedHeaderFactory");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var LaunchGameScene=function(t){function e(){var e=t.call(this)||this;return e.skinName="LaunchGameSceneUI",e.addNativeMessageListener(),e.queryPlatformInfoFromNative(),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addLoadGroupEvent(),this.logoTween.play(0),this.logoTween.addEventListener(egret.Event.COMPLETE,this.logoAnimationComplete,this);var e=AnimationFactory.create("launch_game_animation_json","launch_game_animation_png");this.addChild(e),e.gotoAndPlay("play",-1),RES.loadGroup("answer")},e.prototype.addNativeMessageListener=function(){var t=this;window.document.addEventListener("message",function(e){var n=JSON.parse(e.data);if("query_user_data"===n.command){var o=JSON.parse(n.payload);UserModel.sharedInstance().setAttributes(o),t.joinGame()}else if("query_screen_size"===n.command){var r=n.payload;Device.sharedInstance().setScreenWidth(r.width),Device.sharedInstance().setScreenHeight(r.height)}else"query_platform_name"===n.command&&SQApplication.sharedInstance().setPlatform(n.payload)})},e.prototype.queryDataFromNative=function(){window.postMessage(JSON.stringify({command:"query_user_data"}),"*"),window.postMessage(JSON.stringify({command:"query_screen_size"}),"*")},e.prototype.queryPlatformInfoFromNative=function(){window.postMessage(JSON.stringify({command:"query_platform_name"}),"*")},e.prototype.logoAnimationComplete=function(){this.logoTween.play(0)},e.prototype.addLoadGroupEvent=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onGroupLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onGroupLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onGroupProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this)},e.prototype.removeLoadGroupEvent=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onGroupLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onGroupLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onGroupProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this)},e.prototype.onGroupLoadComplete=function(t){var e=this;this.removeLoadGroupEvent(),setTimeout(function(){SQApplication.sharedInstance().isBaseOnReactNative()?e.queryDataFromNative():e.joinGame()},1e3)},e.prototype.joinGame=function(){var t=this,e=new JoinGameData({user_id:UserModel.sharedInstance().attribute.id});this.descriptionLabel.text="正在加入游戏...",UserModel.sharedInstance().actionModel.joinGame(e,function(e){UserModel.sharedInstance().attribute.setGameId(e.game_id),t.goQuizScene()},function(e){t.joinGame(),console.log(e)})},e.prototype.goQuizScene=function(){var t=this,e=new QuizSceneModel;this.descriptionLabel.text="正在获取数据...",e.fetchQuestions(function(){SQSceneManager.sharedInstance().replaceScene(new QuizScene(e))},function(){t.goQuizScene()})},e.prototype.onGroupLoadError=function(t){console.log("load resource error",t)},e.prototype.onGroupProgress=function(t){this.descriptionLabel.text="资源加载中..."+Math.floor(t.itemsLoaded/t.itemsTotal*100)+"%"},e.prototype.onItemLoadError=function(t){throw new Error(t.resItem.url+"加载失败")},e}(SQScene);__reflect(LaunchGameScene.prototype,"LaunchGameScene");var JoinGameData=function(t){function e(e){var n=t.call(this,e)||this;return n.url=SQApiConfig.Host+"/"+SQApiConfig.V1+"/quiz/marathon/join",n.headerFactory=new NoAuthorizedHeaderFactory({}),n.body.user_id=e.user_id,n}return __extends(e,t),e.prototype.validate=function(t){return this.isLegal=!1,t.access_token?t.user_id?void(this.isLegal=!0):void(this.validateMessage="请提供用户id"):void(this.validateMessage="请传入access_token")},e}(HttpActionData);__reflect(JoinGameData.prototype,"JoinGameData");var QuizScene=function(t){function e(e){var n=t.call(this)||this;return n.skinName="QuizSceneUI",n.model=e,n}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.showQuestion(this.model.getQuestionAtIndex(this.model.currentQuestionAmount)),this.bottomToolbar.setItems(this.model.listBottomToolbarItems()),this.setupCallbacks()},e.prototype.setupCallbacks=function(){this.navigationBar.pressLeftButtonHandler=this.quitGame.bind(this),this.quizDashboard.quizAnswerLayer.pressAnswerHandler=this.chooseAnswer.bind(this),this.quizDashboard.quizFinishedLayer.pressUpButtonHandler=this.approveQuiz.bind(this),this.quizDashboard.quizFinishedLayer.pressDownButtonHandler=this.disapproveQuiz.bind(this),this.quizDashboard.quizFinishedLayer.postQuestionTagHandler=this.postQuestionTag.bind(this),this.quizDashboard.quizFinishedLayer.pressContinueHandler=this.next.bind(this),this.questionLayer.timesUpHandler=this.timesUp.bind(this)},e.prototype.fetchQuestions=function(){var t=this,e=new SQLoadingLayer;e.show(),this.model.fetchQuestions(function(n){e.hide(),t.showQuestion(t.model.getQuestionAtIndex(t.model.currentQuestionAmount))},function(t){e.hide()})},e.prototype.showQuestion=function(t){this.questionLayer.setCategory(t.category),this.questionLayer.setQuestionText(t.text),this.questionLayer.startQuizTimer(20),this.questionLayer.setProgressLabel(""+this.model.getQuestionIndex()),this.quizDashboard.quizAnswerLayer.setAnswers(t.answers),this.model.countQuestionById(t.id,function(){console.log("问题计数成功")},function(t){console.log("问题计数失败"+t.message)})},e.prototype.timesUp=function(){this.quizDashboard.quizAnswerLayer.disableAllButtons(),this.questionLayer.showAnswerTimesUpAnimation(),this.model.setAnswerTimeout(!0),this.model.addAnswerWrongAmount(),this.postAnswer("",100)},e.prototype.chooseAnswer=function(t){var e=this;this.questionLayer.stopQuizTimer(function(n){var o=new ButtonStateEvent(ButtonStateEvent.ANSWER_CORRECT);if(SQEventCenter.sharedInstance().dispatchEvent(o),e.model.setCurrentAnswer(t),t.isCorrect)e.questionLayer.showAnswerCorrectAnimation(),e.model.addAnswerCorrectAmount();else{var r=new ButtonStateEvent(ButtonStateEvent.ANSWER_WRONG);SQEventCenter.sharedInstance().dispatchEvent(r),e.questionLayer.showAnswerWrongAnimation(),e.model.addAnswerWrongAmount()}e.postAnswer(t.name,n)})},e.prototype.postAnswer=function(t,e){var n=this,o=this.model.getQuestionAtIndex(this.model.currentQuestionAmount),r={question_id:o.id,answer_text:t,duration_seconds:e};this.model.postAnswer(r,function(){n.showQuizFinishedLayer(o)},function(o){n.postAnswer(t,e),console.log("发送回答失败, 继续尝试")})},e.prototype.showQuizFinishedLayer=function(t){this.quizDashboard.quizFinishedLayer.setQuestion(t),this.dashboardTween.play(0)},e.prototype.quitGame=function(){var t=new SQAlert;t.show("退出答题","确定要退出吗？",[{name:"取消",onPress:function(){console.log("取消")}},{name:"确定",onPress:function(){SQCrossPlatComunication.closeH5Game()}}])},e.prototype.approveQuiz=function(t){var e={action:"up",question_id:t.id,question_token:t.token};this.model.voteQuestionById(e,function(){},function(t){}),this.delayCallNext()},e.prototype.disapproveQuiz=function(t){var e={action:"down",question_id:t.id,question_token:t.token};this.model.voteQuestionById(e,function(){},function(t){}),this.delayCallNext()},e.prototype.postQuestionTag=function(t,e){var n={question_id:t.id,tag:e.name};this.model.postQuestionTag(n,function(t){console.log("postQuestionTags success #####",t)},function(t){console.log("postQuestionTags failed #####",t.message)}),this.delayCallNext()},e.prototype.delayCallNext=function(){var t=this;setTimeout(function(){t.next()},1e3)},e.prototype.next=function(){if(this.model.getAnswerTimeout())return void SQSceneManager.sharedInstance().addChildLayer(new GameOverScene(this.createGameOverModel()));if(!this.model.getCurrentAnswer().isCorrect)return void SQSceneManager.sharedInstance().addChildLayer(new GameOverScene(this.createGameOverModel()));this.model.currentQuestionAmount+=1,this.model.addQuestionIndex();var t=new ButtonStateEvent(ButtonStateEvent.ANSWER_RESET);return SQEventCenter.sharedInstance().dispatchEvent(t),this.quizDashboard.x=0,this.model.currentQuestionAmount===this.model.totalQuestionAmount?(this.model.reset(),void this.fetchQuestions()):void this.showQuestion(this.model.getQuestionAtIndex(this.model.currentQuestionAmount))},e.prototype.createGameOverModel=function(){var t={answer_correct_amount:this.model.getAnswerCorrectAmount(),answer_wrong_amount:this.model.getAnswerWrongAmount()};return new GameOverSceneModel(t)},e}(SQScene);__reflect(QuizScene.prototype,"QuizScene");var Answer=function(){function t(t){this.name=t.name,this.isCorrect=t.correct,this.index=t.index}return t}();__reflect(Answer.prototype,"Answer");var Question=function(){function t(t){this.category=t.category,this.id=t.id,this.language=t.language,this.text=t.text,this.token=t.question_token,this.answers=this.createAnswers(t.options)}return t.prototype.createAnswers=function(t){return t.map(function(t,e){var n=t;return n.index=e,new Answer(n)})},t}();__reflect(Question.prototype,"Question");var QuizSceneModel=function(){function t(){this.currentQuestionAmount=0,this.httpPost=new HttpPost,this.answerCorrectAmount=0,this.answerWrongAmount=0,this.questionIndex=1}return t.prototype.setCurrentAnswer=function(t){this.currentAnswer=t},t.prototype.getCurrentAnswer=function(){return this.currentAnswer},t.prototype.addAnswerCorrectAmount=function(){this.answerCorrectAmount+=1},t.prototype.getAnswerCorrectAmount=function(){return this.answerCorrectAmount},t.prototype.addAnswerWrongAmount=function(){this.answerWrongAmount+=1},t.prototype.getAnswerWrongAmount=function(){return this.answerWrongAmount},t.prototype.addQuestionIndex=function(){this.questionIndex+=1},t.prototype.getQuestionIndex=function(){return this.questionIndex},t.prototype.setAnswerTimeout=function(t){this.isAnswerTimeout=t},t.prototype.getAnswerTimeout=function(){return this.isAnswerTimeout},t.prototype.reset=function(){this.currentQuestionAmount=0,this.questions=[],this.isAnswerTimeout=!1},t.prototype.getQuestionAtIndex=function(t){return this.questions.length<=t?void 0:this.questions[t]},t.prototype.fetchQuestions=function(t,e){var n=this,o=new FetchQuestionsData({game_id:UserModel.sharedInstance().attribute.getGameId(),access_token:UserModel.sharedInstance().attribute.accessToken,user_id:UserModel.sharedInstance().attribute.id});this.httpPost.execute(o,function(e){n.questions=n.createQuestions(e.questions),n.totalQuestionAmount=n.questions.length,t(n.questions)},function(t){e(t)})},t.prototype.postAnswer=function(t,e,n){var o=new PostAnswerData({game_id:UserModel.sharedInstance().attribute.getGameId(),user_id:UserModel.sharedInstance().attribute.id,question_id:t.question_id,duration_seconds:t.duration_seconds,answer:t.answer_text});this.httpPost.execute(o,function(t){e()},function(t){n(t)})},t.prototype.countQuestionById=function(t,e,n){var o=new CountQuestionData({user_id:UserModel.sharedInstance().attribute.id,question_id:t});this.httpPost.execute(o,function(t){e()},function(t){n(t)})},t.prototype.voteQuestionById=function(t,e,n){var o=new VoteQuestionData({user_id:UserModel.sharedInstance().attribute.id,token:t.question_token,question_id:t.question_id,action:t.action});this.httpPost.execute(o,function(t){e(t)},function(t){n(t)})},t.prototype.postQuestionTag=function(t,e,n){var o=new PostTagData({user_id:UserModel.sharedInstance().attribute.id,question_id:t.question_id,tag:t.tag});this.httpPost.execute(o,function(t){e(t)},function(t){n(t)})},t.prototype.listBottomToolbarItems=function(){return[{icon:"img_bomb@2x_png",title:"炸弹",description:"去掉两个错误答案"},{icon:"img_opportunity@2x_png",title:"机会",description:"多一次机会"},{icon:"img_jump_over@2x_png",title:"跳过",description:"跳过这一题"}]},t.prototype.createQuestions=function(t){return t.map(function(t){return new Question(t)})},t}();__reflect(QuizSceneModel.prototype,"QuizSceneModel");var tagDatas=[{title:"你可以告诉我们问题难度吗？",content:{up:{name:"太简单"},down:{name:"太难了"}}},{title:"你觉得这个问题怎么样？",content:{up:{name:"很有趣"},down:{name:"很无聊"}}},{title:"你有发现答案错误吗？",content:{up:{name:"答案准确"},down:{name:"答案有误"}}},{title:"评价一下这个题型吧？",content:{up:{name:"题型有趣"},down:{name:"题型无聊"}}},{title:"你擅长这种类别题目吗？",content:{up:{name:"擅长"},down:{name:"不擅长"}}},{title:"这个题目小众还是大众，二选一",content:{up:{name:"小众"},down:{name:"大众"}}}],QuizTagType;!function(t){t[t.None=0]="None",t[t.Thumbs=1]="Thumbs",t[t.Tags=2]="Tags"}(QuizTagType||(QuizTagType={}));var QuizTagTypeData=[QuizTagType.None,QuizTagType.None,QuizTagType.None,QuizTagType.None,QuizTagType.None,QuizTagType.Thumbs,QuizTagType.Thumbs,QuizTagType.Tags,QuizTagType.Tags,QuizTagType.Tags],QuizTagModel=function(){function t(){}return t.prototype.randomTagType=function(){return QuizTagTypeData[SQMath.randomInt(QuizTagTypeData.length)]},t.prototype.getRandomTagOption=function(){var t=tagDatas[SQMath.randomInt(tagDatas.length)];return this.randomTagOption=new TagOption(t),this.randomTagOption},t.prototype.getLeftTag=function(){return this.randomTagOption.tags[0]},t.prototype.getRightTag=function(){return this.randomTagOption.tags[1]},t}();__reflect(QuizTagModel.prototype,"QuizTagModel");var TagOption=function(){function t(t){this.title=t.title,this.tags=this.createTags(t.content)}return t.prototype.createTags=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(new Tag(t[n]));return e},t}();__reflect(TagOption.prototype,"TagOption");var Tag=function(){function t(t){this.name=t.name,this.selected=!1}return t}();__reflect(Tag.prototype,"Tag");var CountQuestionData=function(t){function e(e){var n=t.call(this,e)||this;return n.url=SQApiConfig.Host+"/"+SQApiConfig.V1+"/count/"+e.question_id,n.headerFactory=new NoAuthorizedHeaderFactory({}),n.body.user_id=e.user_id,n}return __extends(e,t),e.prototype.validate=function(t){return this.isLegal=!1,t.user_id?void(this.isLegal=!0):void(this.validateMessage="没有找到用户id")},e}(HttpActionData);__reflect(CountQuestionData.prototype,"CountQuestionData");var FetchQuestionsData=function(t){function e(e){var n=t.call(this,e)||this;return n.url=SQApiConfig.Host+"/"+SQApiConfig.V1+"/quiz/marathon/"+e.game_id+"/questions",n.headerFactory=new AuthorizedHeaderFactory({access_token:e.access_token}),n.body.user_id=e.user_id,n}return __extends(e,t),e.prototype.validate=function(t){return this.isLegal=!1,t.access_token?t.user_id?void(this.isLegal=!0):void(this.validateMessage="请提供用户id"):void(this.validateMessage="请传入access_token")},e}(HttpActionData);__reflect(FetchQuestionsData.prototype,"FetchQuestionsData");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var PostTagData=function(t){function e(e){var n=t.call(this,e)||this;return n.url=SQApiConfig.Host+"/"+SQApiConfig.V1+"/tag/"+e.question_id,n.headerFactory=new AuthorizedHeaderFactory({access_token:e.access_token}),n.body.user_id=e.user_id,n.body.tag=e.tag,n}return __extends(e,t),e.prototype.validate=function(t){return this.isLegal=!1,t.user_id?t.tag?void(this.isLegal=!0):void(this.validateMessage="请提供tag"):void(this.validateMessage="请提供用户的id")},e}(HttpActionData);__reflect(PostTagData.prototype,"PostTagData");var VoteQuestionData=function(t){function e(e){var n=t.call(this,e)||this;return n.url=SQApiConfig.Host+"/"+SQApiConfig.V1+"/vote/"+e.question_id,n.headerFactory=new NoAuthorizedHeaderFactory({}),n.body.user_id=e.user_id,n.body.action=e.action,n.body.token=e.token,console.log(e),n}return __extends(e,t),e.prototype.validate=function(t){return this.isLegal=!0,t.user_id?t.action?t.token?t.question_id?void(this.validateMessage="请提供问题id"):void(this.isLegal=!0):void(this.validateMessage="请提供有效问题token"):void(this.validateMessage="没有提供投票行为"):void(this.validateMessage="没有可用用户id")},e}(HttpActionData);__reflect(VoteQuestionData.prototype,"VoteQuestionData");var QuestionLayer=function(t){function e(){var e=t.call(this)||this;return e.skinName="QuestionLayerUI",e}return __extends(e,t),e.prototype.showAnswerTimesUpAnimation=function(){var t=this,e=AnimationFactory.create("answer_times_up_animation_json","answer_times_up_animation_png");this.animationContainer.addChild(e),this.animationContainer.layout=this.createAnimationContainerLayout(),e.gotoAndPlay("play",0),e.addEventListener(egret.MovieClipEvent.COMPLETE,function(){t.animationContainer.removeChild(e)},this)},e.prototype.showAnswerCorrectAnimation=function(){var t=this,e=AnimationFactory.create("answer_correct_animation_json","answer_correct_animation_png");this.animationContainer.addChild(e),this.animationContainer.layout=this.createAnimationContainerLayout(),e.gotoAndPlay("play",0),e.addEventListener(egret.MovieClipEvent.COMPLETE,function(){t.animationContainer.removeChild(e)},this)},e.prototype.showAnswerWrongAnimation=function(){var t=this,e=AnimationFactory.create("answer_wrong_animation_json","answer_wrong_animation_png");this.animationContainer.addChild(e),this.animationContainer.layout=this.createAnimationContainerLayout(),e.gotoAndPlay("play",0),e.addEventListener(egret.MovieClipEvent.COMPLETE,function(){t.animationContainer.removeChild(e)},this)},e.prototype.createAnimationContainerLayout=function(){var t=new eui.HorizontalLayout;return t.gap=0,t.horizontalAlign=egret.HorizontalAlign.CENTER,t.verticalAlign=egret.VerticalAlign.MIDDLE,t},e.prototype.setCategory=function(t){this.categoryLabel.text=t},e.prototype.setProgressLabel=function(t){this.progressLabel.text=t},e.prototype.startQuizTimer=function(t){this.timer||(this.initialTime=t,this.remainTime=t,this.timer=new egret.Timer(1e3,t),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerCalled,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerCompleted,this),this.timeLabel.text=t+'"',this.timer.start())},e.prototype.stopQuizTimer=function(t){t(this.initialTime-this.remainTime),this.stopTimer()},e.prototype.setQuestionText=function(t){this.questionLabel.text=t},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.animationContainer=new eui.Group,this.animationContainer.width=this.width,this.animationContainer.height=this.height,this.animationContainer.y=-140,this.addChild(this.animationContainer)},e.prototype.stopTimer=function(){this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerCalled,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerCompleted,this),this.timer=void 0)},e.prototype.timerCalled=function(){this.remainTime-=1,this.timeLabel.text=this.remainTime+'"'},e.prototype.timerCompleted=function(){this.stopTimer(),this.timesUpHandler()},e}(SQLayer);__reflect(QuestionLayer.prototype,"QuestionLayer");var QuizAnswerButton=function(t){function e(){var e=t.call(this)||this;return e.skinName="QuizAnswerButtonUI",e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTapBegin,e),e.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,e.onTapReleaseOutside,e),e.addEventListener(egret.TouchEvent.TOUCH_END,e.onTappEnd,e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onTapped,e),SQEventCenter.sharedInstance().addEventListener(ButtonStateEvent.ANSWER_RESET,e.reset,e),e}return __extends(e,t),e.prototype.setAnswer=function(t){this.answer=t,this.setTitle(t.name),SQEventCenter.sharedInstance().removeEventListener(ButtonStateEvent.ANSWER_CORRECT,this.showCorrectState,this),SQEventCenter.sharedInstance().addEventListener(ButtonStateEvent.ANSWER_CORRECT,this.showCorrectState,this)},e.prototype.showCorrectState=function(){this.answer.isCorrect&&(this.currentState="correct")},e.prototype.showWrongState=function(){this.currentState="wrong"},e.prototype.reset=function(){this.currentState="up",SQEventCenter.sharedInstance().removeEventListener(ButtonStateEvent.ANSWER_WRONG,this.showWrongState,this)},e.prototype.setTitle=function(t){this.titleLabel.text=t
},e.prototype.onTapped=function(){SQEventCenter.sharedInstance().addEventListener(ButtonStateEvent.ANSWER_WRONG,this.showWrongState,this)},e.prototype.onTapBegin=function(){this.titleLabel.visible=!1},e.prototype.onTapReleaseOutside=function(){this.titleLabel.visible=!0},e.prototype.onTappEnd=function(){this.titleLabel.visible=!0},e}(eui.Button);__reflect(QuizAnswerButton.prototype,"QuizAnswerButton");var QuizAnswerLayer=function(t){function e(){var e=t.call(this)||this;return e.skinName="QuizAnswerLayerUI",e.answerOne.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressAnswerOne,e),e.answerTwo.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressAnswerTwo,e),e.answerThree.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressAnswerThree,e),e.answerFour.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressAnswerFour,e),e}return __extends(e,t),e.prototype.setAnswers=function(t){this.answers=t,this.enableAllButtons(),this.answerOne.setAnswer(t[0]),this.answerTwo.setAnswer(t[1]),this.answerThree.setAnswer(t[2]),this.answerFour.setAnswer(t[3])},e.prototype.disableAllButtons=function(){this.answerOne.enabled=!1,this.answerTwo.enabled=!1,this.answerThree.enabled=!1,this.answerFour.enabled=!1},e.prototype.onPressAnswerOne=function(){this.disableAllButtons(),this.pressAnswerHandler&&this.pressAnswerHandler(this.answers[0])},e.prototype.onPressAnswerTwo=function(){this.disableAllButtons(),this.pressAnswerHandler&&this.pressAnswerHandler(this.answers[1])},e.prototype.onPressAnswerThree=function(){this.disableAllButtons(),this.pressAnswerHandler&&this.pressAnswerHandler(this.answers[2])},e.prototype.onPressAnswerFour=function(){this.disableAllButtons(),this.pressAnswerHandler&&this.pressAnswerHandler(this.answers[3])},e.prototype.enableAllButtons=function(){this.answerOne.enabled=!0,this.answerTwo.enabled=!0,this.answerThree.enabled=!0,this.answerFour.enabled=!0},e}(SQLayer);__reflect(QuizAnswerLayer.prototype,"QuizAnswerLayer");var QuizDashboardLayer=function(t){function e(){var e=t.call(this)||this;return e.skinName="QuizDashboardUI",e}return __extends(e,t),e}(SQLayer);__reflect(QuizDashboardLayer.prototype,"QuizDashboardLayer");var QuizFinishedLayer=function(t){function e(){var e=t.call(this)||this;return e.skinName="QuizFinishedLayerUI",e.upButton.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressUpButton,e),e.downButton.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressDownButton,e),e.leftTagButton.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressLeftTagButton,e),e.rightTagButton.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressRightTagButton,e),e.continueButton.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressContinueButton,e),e.tagModel=new QuizTagModel,e}return __extends(e,t),e.prototype.setQuestion=function(t){var e=this.tagModel.randomTagType();if(this.enableAllButtons(!0),e===QuizTagType.None)this.thumbsGroup.visible=!1,this.tagsGroup.visible=!1;else if(e===QuizTagType.Tags){this.thumbsGroup.visible=!1;var n=this.tagModel.getRandomTagOption();this.leftTagButton.labelDisplay.text=n.tags[0].name,this.rightTagButton.labelDisplay.text=n.tags[1].name,this.tagTitleLabel.text=n.title,this.tagsGroup.visible=!0}else e===QuizTagType.Thumbs&&(this.thumbsGroup.visible=!0,this.tagsGroup.visible=!1);this.question=t},e.prototype.enableAllButtons=function(t){this.upButton.enabled=t,this.downButton.enabled=t,this.leftTagButton.enabled=t,this.rightTagButton.enabled=t,this.continueButton.enabled=t},e.prototype.onPressUpButton=function(){this.enableAllButtons(!1),this.pressUpButtonHandler(this.question)},e.prototype.onPressDownButton=function(){this.enableAllButtons(!1),this.pressDownButtonHandler(this.question)},e.prototype.onPressContinueButton=function(){this.enableAllButtons(!1),this.reset(),this.pressContinueHandler&&this.pressContinueHandler()},e.prototype.onPressLeftTagButton=function(){this.enableAllButtons(!1),this.postQuestionTagHandler(this.question,this.tagModel.getLeftTag())},e.prototype.onPressRightTagButton=function(){this.enableAllButtons(!1),this.postQuestionTagHandler(this.question,this.tagModel.getRightTag())},e.prototype.reset=function(){this.upButton.selected=!1,this.downButton.selected=!1},e}(SQLayer);__reflect(QuizFinishedLayer.prototype,"QuizFinishedLayer");var QuizSceneBottomToolbar=function(t){function e(){var e=t.call(this)||this;return e.skinName="QuizSceneBottomToolbarUI",e.bombButton.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressBombButton,e),e.chanceButton.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressChanceButton,e),e.skipButton.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressSkipButton,e),e}return __extends(e,t),e.prototype.setItems=function(t){if(3===t.length){var e=t[0];this.bombButton.setIcon(e.icon),this.bombButton.setTitle(e.title),this.bombButton.setDescription(e.description);var n=t[1];this.chanceButton.setIcon(n.icon),this.chanceButton.setTitle(n.title),this.chanceButton.setDescription(n.description);var o=t[2];this.skipButton.setIcon(o.icon),this.skipButton.setTitle(o.title),this.skipButton.setDescription(o.description)}},e.prototype.onPressBombButton=function(){},e.prototype.onPressChanceButton=function(){},e.prototype.onPressSkipButton=function(){},e}(SQLayer);__reflect(QuizSceneBottomToolbar.prototype,"QuizSceneBottomToolbar");var QuizSceneBottomToolbarItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="QuizSceneBottomToolbarItemUI",e}return __extends(e,t),e.prototype.setIcon=function(t){this.icon.source=t},e.prototype.setTitle=function(t){this.titleLabel.text=t},e.prototype.setDescription=function(t){this.descriptionLabel.text=t},e}(SQLayer);__reflect(QuizSceneBottomToolbarItem.prototype,"QuizSceneBottomToolbarItem");var UserAttribute=function(){function t(t){this.id=UUID.generate(),this.accessToken=UUID.generate()}return t.prototype.setGameId=function(t){this.gameId=t},t.prototype.getGameId=function(){return this.gameId},t}();__reflect(UserAttribute.prototype,"UserAttribute",["IAttribute"]);var UserModel=function(){function t(){this.attribute=new UserAttribute({}),this.actionModel=new UserActionModel}return t.sharedInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.setAttributes=function(t){this.attribute.id=t.user.id,this.attribute.accessToken=t.auth.access_token},t}();__reflect(UserModel.prototype,"UserModel");var UserActionModel=function(){function t(){this.httpPost=new HttpPost}return t.prototype.joinGame=function(t,e,n){this.httpPost.execute(t,e,n)},t}();__reflect(UserActionModel.prototype,"UserActionModel",["IUserAction"]);var AnimationFactory=function(){function t(){}return t.create=function(t,e){var n=RES.getRes(t),o=RES.getRes(e),r=new egret.MovieClipDataFactory(n,o);return new egret.MovieClip(r.generateMovieClipData("animation"))},t}();__reflect(AnimationFactory.prototype,"AnimationFactory");var Device=function(){function t(){}return t.sharedInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.setScreenWidth=function(t){this.screenWidth=t},t.prototype.setScreenHeight=function(t){this.screenHeight=t},t.prototype.isPCBrowser=function(){var t=!0;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!1)}(navigator.userAgent||navigator.vendor),t},t}();__reflect(Device.prototype,"Device");var SQApplication=function(){function t(){}return t.sharedInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.setPlatform=function(t){this.platform=t},t.prototype.getPlatform=function(){return this.platform},t.prototype.isBaseOnReactNative=function(){return"react_native"===this.platform},t}();__reflect(SQApplication.prototype,"SQApplication");var SQCrossPlatComunication=function(){function t(){}return t.closeH5Game=function(){SQApplication.sharedInstance().isBaseOnReactNative()&&window.postMessage(JSON.stringify({command:"close_webview"}),"*")},t}();__reflect(SQCrossPlatComunication.prototype,"SQCrossPlatComunication");var SQMath=function(){function t(){}return t.randomInt=function(t){return Math.floor(Math.random()*Math.floor(t))},t}();__reflect(SQMath.prototype,"SQMath");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,o){function r(t){e.call(o,t)}function i(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),n.call(o))}var s=this;"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(o,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(o,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var ButtonStateEvent=function(t){function e(e,n,o){return void 0===n&&(n=!1),void 0===o&&(o=!1),t.call(this,e,n,o)||this}return __extends(e,t),e.ANSWER_CORRECT="event.button.state.answer.correct",e.ANSWER_WRONG="event.button.state.answer.wrong",e.ANSWER_RESET="event.button.state.answer.reset",e}(egret.Event);__reflect(ButtonStateEvent.prototype,"ButtonStateEvent");var SQPopupLayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(SQLayer);__reflect(SQPopupLayer.prototype,"SQPopupLayer");var ListItemEvent=function(t){function e(e,n,o){return void 0===n&&(n=!1),void 0===o&&(o=!1),t.call(this,e,n,o)||this}return __extends(e,t),e.ITEM_TAPPED="list.item.tapped.event",e}(egret.Event);__reflect(ListItemEvent.prototype,"ListItemEvent");var SQSceneManager=function(t){function e(){var e=t.call(this)||this;return e.sceneStack=new eui.ViewStack,e.scenes=[],e}return __extends(e,t),e.sharedInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addRootStage=function(t){this.rootStage=t,this.rootStage.addChild(this.sceneStack)},e.prototype.addChildLayer=function(t){if(!t)throw new Error("无法添加不存在的layer");this.rootStage.addChild(t),t.onEnter()},e.prototype.removeChildLayer=function(t){if(!t)throw new Error("无法移出不存在的scene");t.parent&&(t.onExit(),this.rootStage.removeChild(t),t=void 0)},e.prototype.pushScene=function(t){if(!t)throw new Error("你不能push一个不存在的scene");this.sceneStack.addChild(t),t.onEnter(),this.scenes.push(t),this.sceneStack.selectedIndex=this.sceneStack.length-1},e.prototype.popScene=function(){if(1<=this.scenes.length){var t=this.scenes.pop();t.onExit();var e=this.sceneStack.removeChild(t);this.sceneStack.selectedIndex=this.sceneStack.length-1,this.sceneStack.selectedIndex<0&&(this.sceneStack.selectedIndex=0),e=void 0}},e.prototype.replaceScene=function(t){if(!t)throw new Error("你不能replace一个不存在的scene");this.popScene(),this.pushScene(t)},e.instance=void 0,e}(egret.DisplayObjectContainer);__reflect(SQSceneManager.prototype,"SQSceneManager");var NavigationBar=function(t){function e(){var e=t.call(this)||this;return e.skinName="NavigationBarUI",e.leftButton.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onPressLeftButton,e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),SQApplication.sharedInstance().isBaseOnReactNative()||(this.leftButton.visible=!1)},e.prototype.onPressLeftButton=function(){this.pressLeftButtonHandler&&this.pressLeftButtonHandler()},e}(SQLayer);__reflect(NavigationBar.prototype,"NavigationBar");var PureTextButton=function(t){function e(){var e=t.call(this)||this;return e.skinName="PureTextButtonUI",e}return __extends(e,t),e}(SQLayer);__reflect(PureTextButton.prototype,"PureTextButton");var SQAlert=function(t){function e(){var e=t.call(this)||this;return e.skinName="SQAlertUI",e}return __extends(e,t),e.prototype.show=function(t,e,n){var o=this;t&&(this.titleLabel.text=t),e&&(this.messageLabel.text=e),n&&n.forEach(function(t){var e=new SQAlertButton;e.setTitle(t.name),"确定"===t.name&&e.setBackgroundColor(13912907),e.setCallback(function(){t.onPress(),SQSceneManager.sharedInstance().removeChildLayer(o)}),o.buttonsGroup.addChild(e)}),SQSceneManager.sharedInstance().addChildLayer(this)},e}(SQLayer);__reflect(SQAlert.prototype,"SQAlert");var SQAlertButton=function(t){function e(){var e=t.call(this)||this;return e.skinName="SQAlertButtonUI",e}return __extends(e,t),e.prototype.setTitle=function(t){this.titleLabel.text=t},e.prototype.setBackgroundColor=function(t){this.background.fillColor=t},e.prototype.setCallback=function(t){this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t()},this)},e}(SQLayer);__reflect(SQAlertButton.prototype,"SQAlertButton");var SQLoadingLayer=function(t){function e(){var e=t.call(this)||this;e.skinName="LoadingLayerUI";var n=RES.getRes("loading_animation_json"),o=RES.getRes("loading_animation_png"),r=new egret.MovieClipDataFactory(n,o);return e.loadingAnimation=new egret.MovieClip(r.generateMovieClipData("loading_animation")),e.addChild(e.loadingAnimation),e.loadingAnimation.x=(e.width-e.loadingAnimation.width)/2,e.loadingAnimation.y=(e.height-e.loadingAnimation.height)/2,e.loadingAnimation.addEventListener(egret.MovieClipEvent.COMPLETE,function(){e.loadingAnimation.gotoAndPlay("play",0)},e),e}return __extends(e,t),e.prototype.show=function(){this.loadingAnimation.gotoAndPlay("play",0),SQSceneManager.sharedInstance().addChildLayer(this)},e.prototype.hide=function(){this.loadingAnimation.gotoAndStop(0),this.removeChild(this.loadingAnimation),this.loadingAnimation=void 0,SQSceneManager.sharedInstance().removeChildLayer(this)},e}(SQLayer);__reflect(SQLoadingLayer.prototype,"SQLoadingLayer");var TransparentLayer=function(t){function e(){var e=t.call(this)||this;return e.skinName="TransparentLayerUI",e}return __extends(e,t),e}(SQLayer);__reflect(TransparentLayer.prototype,"TransparentLayer");